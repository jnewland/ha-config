name: Rancho de Newland
views:
  - title: Home
    icon: mdi:home
    theme: dark-mode
    cards:
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-glance
          camera_image: camera.pergola
          entities:
            - input_select.mode
            - alarm_control_panel.alarm
            - lock.front_door
            - binary_sensor.front_gate_access_control_window_door_is_open
            - input_number.brightness
            - vacuum.downstairs
      - type: conditional
        conditions:
          - entity: device_tracker.jphone_12
            state: "not_home"
          - entity: device_tracker.katie_s_iphone
            state: "not_home"
        card:
          type: picture-entity
          show_name: false
          show_state: false
          entity: camera.great_room

      - type: conditional
        conditions:
          - entity: input_boolean.visitor
            state: "off"
        card:
          type: entities
          show_header_toggle: false
          entities:
            - input_boolean.visitor

      - type: conditional
        conditions:
          - entity: input_boolean.visitor
            state: "on"
        card:
          type: entities
          show_header_toggle: false
          entities:
            - input_boolean.visitor
            - sensor.visitor_door_code

      - type: vertical-stack
        cards:
          - type: custom:mini-media-player
            entity: media_player.house
            artwork: cover
            hide:
              power: true
              shuffle: false
            speaker_group:
              platform: sonos
              show_group_count: true
              entities:
                - entity_id: media_player.house
                  name: house
                - entity_id: media_player.sub
                  name: sub
                - entity_id: media_player.record_cabinet
                  name: record cabinet
                - entity_id: media_player.lounge_surround
                  name: lounge surround
                - entity_id: media_player.move
                  name: move
                - entity_id: media_player.yoga
                  name: yoga
                - entity_id: media_player.shower
                  name: shower
                - entity_id: media_player.master_patio
                  name: master patio
                - entity_id: media_player.back_porch
                  name: back porch
                - entity_id: media_player.front_porch
                  name: front porch
                - entity_id: media_player.pergola
                  name: pergola
                - entity_id: media_player.rock
                  name: rock
          - type: conditional
            conditions:
              - entity: media_player.house
                state: playing
            card:
              type: entities
              show_header_toggle: false
              entities:
                - type: custom:mini-media-player
                  entity: media_player.atrium_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: custom:mini-media-player
                  entity: media_player.kitchen_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: custom:mini-media-player
                  entity: media_player.living_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: custom:mini-media-player
                  entity: media_player.master_bathroom_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: custom:mini-media-player
                  entity: media_player.master_bedroom_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: custom:mini-media-player
                  entity: media_player.patio_speakers
                  group: true
                  source: icon
                  info: short
                  hide:
                    controls: true
                    source: true
                - type: conditional
                  conditions:
                    - entity: media_player.back_porch
                      state_not: "idle"
                    - entity: media_player.back_porch
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.back_porch
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.front_porch
                      state_not: "idle"
                    - entity: media_player.front_porch
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.front_porch
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.yoga
                      state_not: "idle"
                    - entity: media_player.yoga
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.yoga
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.lounge_surround
                      state_not: "idle"
                    - entity: media_player.lounge_surround
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.lounge_surround
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.master_patio
                      state_not: "idle"
                    - entity: media_player.master_patio
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.master_patio
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.move
                      state_not: "idle"
                    - entity: media_player.move
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.move
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.rock
                      state_not: "idle"
                    - entity: media_player.rock
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.rock
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.pergola
                      state_not: "idle"
                    - entity: media_player.pergola
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.pergola
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.record_cabinet
                      state_not: "idle"
                    - entity: media_player.record_cabinet
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.record_cabinet
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.sub
                      state_not: "idle"
                    - entity: media_player.sub
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.sub
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true
                - type: conditional
                  conditions:
                    - entity: media_player.shower
                      state_not: "idle"
                    - entity: media_player.shower
                      state_not: "paused"
                  row:
                    type: custom:mini-media-player
                    entity: media_player.shower
                    group: true
                    source: icon
                    info: short
                    hide:
                      controls: true
                      source: true
                      power: true
                      progress: true

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: name
        card:
          type: entities
          show_header_toggle: false
        filter:
          include:
            - attributes:
                supported_features: 450487
            - entity_id: "/media_player.*_channels$/"
            - entity_id: "/media_player.*_tv.*/"
            - entity_id: "/media_player.*_surround$/"
          exclude:
            - state: "problem"
            - state: "ok"
            - state: "off"
            - state: "unavailable"
            - state: "idle"
            - state: "paused"
            - state: "unknown"
            - state: "standby"

      - type: conditional
        conditions:
          - entity: input_boolean.winterized
            state: "on"
        card:
          type: entities
          entities:
            - input_boolean.winterized
            - weather.dark_sky
            - binary_sensor.freeze_forecast
      - type: conditional
        conditions:
          - entity: input_boolean.christmas
            state: "on"
        card:
          type: custom:group-card
          card:
            type: entities
          group: group.trees

      - type: entities
        show_header_toggle: false
        entities:
          - cover.garage
          - cover.gate
          - lock.garage

      - type: conditional
        conditions:
          - entity: camera.front_door_person
            state: active
        card:
          type: picture-entity
          show_name: false
          show_state: false
          entity: camera.front_door_person
      - type: conditional
        conditions:
          - entity: camera.pergola_person
            state: active
        card:
          type: picture-entity
          show_name: false
          show_state: false
          entity: camera.pergola_person


      - type: custom:custom-sonos-card
        mediaTitle: " "
        shuffleFavorites: false
        selectedPlayer: media_player.house
        layout:
          mediaBrowser:
            width: '100%'
            mobileWidth: '100%'
          mediaItem:
            width: '25%'
            mobileWidth: '33%'
        styles:
            groups:
              display: none
            players:
              display: none
            ha-card:
              background: none
            button-section:
              background: none
              border: none
            media-button:
              border: none
            media-button-title:
              textOverflow: clip
      - type: weather-forecast
        entity: weather.dark_sky
      - type: picture
        image: https://radblast.wunderground.com/cgi-bin/radar/WUNIDS_map?station=GRK&brand=wui&num=10&delay=25&type=N0R&frame=0&scale=1&noclutter=0&showstorms=99&mapx=400&mapy=240&centerx=400&centery=240&transx=0&transy=0&showlabels=1&severe=1&rainsnow=1&lightning=1&smooth=1&rand=24691285&lat=0&lon=0&label=you

  - title: Garden
    path: garden
    icon: mdi:sprout
    cards:
      - type: entities
        show_header_toggle: false
        title: Greenhouse
        entities:
          - automation.greenhouse_light_automation
          - switch.greenhouse_light
          # - switch.greenhouse_right
      - type: conditional
        conditions:
          - entity: automation.greenhouse_light_automation
            state: "on"
        card:
          type: entities
          title: Greenhouse light automation
          show_header_toggle: false
          entities:
            - input_datetime.greenhouse_light_on
            - input_datetime.greenhouse_light_off
      #   footer:
      #     type: graph
      #     entity: sensor.angel_trumpet_light
      #     hours_to_show: 80
      #     detail: 2
      # - type: entities
      #   title: Kitchen herb garden
      #   show_header_toggle: false
      #   entities:
      #     - light.kitchen_light
      #     - binary_sensor.kitchen_pump
      #     - binary_sensor.kitchen_needs_nutrients
      #     - binary_sensor.kitchen_needs_water
      #     - sensor.kitchen_nutrients_days
      #     - sensor.kitchen_planted_days

      - type: custom:auto-entities
        card:
          type: entities
          show_header_toggle: false
          title: quick run
        filter:
          include:
            - entity_id: "/.*_sprayers$/"
            - entity_id: "/.*_drip$/"
            - entity_id: "/.*_zone$/"
            - entity_id: "/.*_schedule$/"

      - type: custom:auto-entities
        card:
          type: entities
          show_header_toggle: false
          title: schedule
        filter:
          include:
            - entity_id: "/.*_program$/"

      - type: custom:auto-entities
        card:
          type: entities
          show_header_toggle: false
          title: rain delay
        filter:
          include:
            - entity_id: "/.*_rain_delay$/"

      - type: custom:auto-entities
        card:
          type: entities
          show_header_toggle: false
          title: last run
        filter:
          include:
            - integration: bhyve
              entity_id: "/.*_history$/"

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: consumption
          hours_to_show: 168
          group_by: date
          smoothing: false
          show:
            fill: false
            legend: false
            state: false
        filter:
          include:
            - entity_id: "/.*_zone_history$/"
              options:
                aggregate_func: sum
                attribute: consumption_gallons
                unit: gallons

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: irrigation zone runtime
          hours_to_show: 168
          group_by: date
          smoothing: false
          show:
            fill: false
            legend: false
            state: false
        filter:
          include:
            - entity_id: "/.*_zone_daily_runtime$/"
              options:
                aggregate_func: max
                unit: hours

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          hours_to_show: 168
          group_by: hour
          show:
            extrema: true
            state: false
            fill: false
        filter:
          include:
            - entity_id: "/.*_soil_conductivity$/"

      - type: custom:mini-graph-card
        entities:
          - entity: sensor.dark_sky_temperature
            aggregate_func: max
            name: Max
            color: #e74c3c
          - entity: sensor.dark_sky_temperature
            aggregate_func: min
            name: Min
          - entity: sensor.dark_sky_temperature
            aggregate_func: avg
            name: Avg
            color: green
        name: outdoor temperature range
        hours_to_show: 168
        group_by: date
        show:
          fill: false
          extrema: true
          state: false

      - type: custom:mini-graph-card
        entities:
          - entity: sensor.dark_sky_temperature
          - entity: sensor.peppers_temperature
          - entity: sensor.bamboo_temperature
        name: outdoor temperature
        hours_to_show: 72
        group_by: hour
        show:
          fill: false

      - type: custom:mini-graph-card
        entities:
          - entity: sensor.bamboo_light
          - entity: sensor.peppers_light
        name: outdoor light
        hours_to_show: 72
        group_by: hour
        show:
          extrema: true
          state: false
          fill: false

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          hours_to_show: 72
          group_by: hour
          show:
            extrema: true
            state: false
            fill: false
        filter:
          include:
            - entity_id: "/.*_rssi$/"

      - type: conditional
        conditions:
          - entity: binary_sensor.precipitation_in_forecast
            state: "on"
        card:
          type: custom:mini-graph-card
          entities:
            - sensor.hours_until_rain
          name: hours until rain
          hours_to_show: 36
          show:
            fill: false

      - type: conditional
        conditions:
          - entity: binary_sensor.precipitation_in_forecast
            state: "on"
        card:
          type: custom:mini-graph-card
          entities:
            - sensor.precipitation_in_forecast
          name: precipitation in forecast
          hours_to_show: 36
          show:
            fill: false

      - type: entities
        title: Precipitation
        show_header_toggle: false
        entities:
          - input_number.precipitation_forecast_hours
          - binary_sensor.precipitation_in_forecast
          - automation.precipitation_notifications
          - automation.sunshine_notifications

  - title: Great Room
    icon: mdi:sofa
    cards:
      - type: entities
        title: great room
        entities:
          - light.kitchen_cabinets
          - light.kitchen
          - light.pendants
          - light.dining_room_table
          - binary_sensor.dining_room_home_security_motion_detection
          - light.pantry
          - binary_sensor.pantry_home_security_motion_detection
          - light.living
          - light.couch_lamp_right
          - light.couch_lamp_left
          - binary_sensor.great_room_occupancy
          - sensor.dining_room_air_temperature
        footer:
          type: graph
          entity: sensor.dining_room_air_temperature
          hours_to_show: 36
          detail: 2

  - title: Lounge
    icon: mdi:television-classic
    cards:
      - type: entities
        title: lounge
        entities:
          - light.lounge_overhead
          - light.lounge_chandelier
          - light.tv_left
          - light.tv_right
          - switch.lounge_left
          - switch.lounge_right
          - binary_sensor.lounge_home_security_motion_detection
          - sensor.lounge_air_temperature
        footer:
          type: graph
          entity: sensor.lounge_air_temperature
          hours_to_show: 36
          detail: 2
      - type: media-control
        entity: media_player.lg_webos_tv_d510
      - type: media-control
        entity: media_player.lounge
      - type: media-control
        entity: media_player.lounge_channels
      - type: entities
        title: guest
        entities:
          - light.guest_hall_overhead
          - light.guest_bath_mirror
          - light.guest_shower
          - binary_sensor.guest_bath_home_security_motion_detection
          - binary_sensor.guest_hall_home_security_motion_detection
          - sensor.guest_bath_air_temperature
          - switch.guest_bath_fan
        footer:
          type: graph
          entity: sensor.guest_bath_air_temperature
          hours_to_show: 36
          detail: 2

  - title: Music Room
    icon: mdi:guitar-pick
    cards:
      - type: entities
        title: music room
        entities:
          - light.music_room
          - light.music_room_fan_light
          - fan.music_room
          - binary_sensor.music_room_occupancy
          - binary_sensor.music_room_fan_occupancy
          - binary_sensor.music_room_home_security_motion_detection
          - binary_sensor.music_room_window
          - sensor.music_room_air_temperature
          - binary_sensor.bookshelf_active
          - binary_sensor.bookshelf_camera_in_use
          - sensor.bookshelf_frontmost_app
        footer:
          type: graph
          entity: sensor.music_room_air_temperature
          hours_to_show: 36
          detail: 2
      - type: media-control
        entity: media_player.music_room
      - type: media-control
        entity: media_player.music_room_channels

  - title: Yoga Studio
    icon: mdi:yoga
    cards:
      - type: entities
        title: yoga studio
        entities:
          - light.yoga_room
          - light.marble_lamp
          - light.yoga_closet
          - binary_sensor.yoga_room_home_security_motion_detection
          - binary_sensor.yoga_chair_home_security_motion_detection
          - binary_sensor.yoga_room_occupancy
          - cover.yoga_room_shades
          - sensor.yoga_room_air_temperature
        footer:
          type: graph
          entity: sensor.yoga_room_air_temperature
          hours_to_show: 36
          detail: 2
      - type: custom:mini-media-player
        entity: media_player.yoga
        artwork: cover
        hide:
          power: true
          shuffle: false


  - title: Upstairs
    icon: mdi:bed
    cards:
      - type: entities
        title: bedroom
        entities:
          - light.bedroom_chandelier
          - light.bedroom_overhead
          - light.bedroom_nook
          - light.bedroom_windows
          - light.bedside_lamp
          - light.bedside_table
          - light.chandelier_lamp
          - light.bedroom_patio
          - light.bedroom_closet
          - binary_sensor.closet_motion_any
          - binary_sensor.bedroom_door_access_control_window_door_is_open
          - cover.bedroom_shades
      - type: entities
        title: bath
        entities:
          - light.bathroom_overhead
          - light.bathroom_mirror
          - light.bathroom_shower
          - switch.bathroom_fan
          - light.bathroom_toilet
          - binary_sensor.bathroom_home_security_motion_detection
          - sensor.bathroom_air_temperature
          - cover.master_bathroom_shade
        footer:
          type: graph
          entity: sensor.bathroom_air_temperature
          hours_to_show: 36
          detail: 2
      - type: media-control
        entity: media_player.bedroom
      - type: media-control
        entity: media_player.bedroom_channels

  - title: Grill
    icon: mdi:grill
    cards:
      - type: entities
        title: pergola
        entities:
          - light.pergola_pendants
          - switch.pergola_overhead
      - type: markdown
        content: |
          [View cook on Flameboss]({{ states('sensor.flameboss_cook_link') }})
      - type: entities
        entities:
          - sensor.grill_probe_temp
          - sensor.red_probe_temp
          - sensor.green_probe_temp
          - sensor.black_probe_temp
      - type: custom:mini-graph-card
        hours_to_show: 1
        points_per_hour: 120
        lower_bound: 100
        name: last hour
        entities:
          - sensor.grill_probe_temp
          - sensor.red_probe_temp
          - sensor.green_probe_temp
          - sensor.black_probe_temp
        show:
          fill: false
          extrema: true
          state: false

      - type: custom:mini-graph-card
        hours_to_show: 3
        points_per_hour: 120
        lower_bound: 100
        name: last 3 hours
        entities:
          - sensor.grill_probe_temp
          - sensor.red_probe_temp
          - sensor.green_probe_temp
          - sensor.black_probe_temp
        show:
          fill: false
          extrema: true
          state: false

      - type: custom:mini-media-player
        entity: media_player.pergola
        artwork: cover
        hide:
          power: true
          shuffle: false

  - title: Outdoor
    icon: mdi:tree
    cards:
      - type: entities
        title: back porch
        entities:
          - switch.back_porch
          - group.back_porch_fan
          - switch.back_porch_fountain
          - light.ac
          - lock.back_porch
      - type: entities
        title: atrium
        entities:
          - switch.atrium_fan
          - light.bamboo
          - light.atrium
          - light.atrium_door
          - light.garage_door
          - light.gate
          - switch.atrium_fountain
          - lock.garage
          - cover.garage
          - cover.gate
          - binary_sensor.atrium_occupancy
          - binary_sensor.atrium_couch_motion
      - type: entities
        title: front porch
        entities:
          - light.front_porch
          - light.front_door
          - binary_sensor.front_gate_access_control_window_door_is_open
      - type: entities
        title: patio
        entities:
          - light.patio
          - light.bedroom_patio
      - type: entities
        title: pergola
        entities:
          - light.pergola_pendants
          - switch.pergola_overhead
      - type: entities
        entities:
          - binary_sensor.front_gate_access_control_window_door_is_open
          - cover.garage
          - cover.gate
      - type: history-graph
        hours_to_show: 3
        entities:
          - binary_sensor.atrium_occupancy
          - binary_sensor.pergola_occupancy
          - binary_sensor.back_porch_occupancy
          - binary_sensor.front_porch_occupancy

  - title: Cameras
    icon: mdi:video
    cards:
      - type: conditional
        conditions:
          - entity: device_tracker.jphone_12
            state: "not_home"
          - entity: device_tracker.katie_s_iphone
            state: "not_home"
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.great_room
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.front_yard_left
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.atrium
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.gate
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.garage
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.back_porch
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.ac

      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.front_door
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.pergola
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.roof_deck
      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: picture-entity
          camera_view: live
          show_name: false
          show_state: false
          entity: camera.peppers

      - type: conditional
        conditions:
          - entity: camera.pergola
            state: recording
        card:
          type: grid
          square: false
          columns: 2
          cards:
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.front_door_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.pergola_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.front_yard_left_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.atrium_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.back_porch_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.gate_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.garage_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.ac_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.roof_deck_person
            - type: picture-entity
              show_name: false
              show_state: false
              entity: camera.peppers_person

      - type: custom:auto-entities
        show_header_toggle: false
        show_empty: false
        sort:
          method: name
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/sensor..*_person$/"
            - entity_id: "/sensor..*_dog$/"
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/_occupancy/"
      - type: custom:auto-entities
        show_header_toggle: false
        show_empty: false
        sort:
          method: name
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/sensor..*_camera_fps$/"
      - type: custom:auto-entities
        show_header_toggle: false
        show_empty: false
        sort:
          method: name
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/sensor..*_detection_fps$/"
      - type: custom:auto-entities
        show_header_toggle: false
        show_empty: false
        sort:
          method: name
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/sensor..*_process_fps$/"
      - type: custom:auto-entities
        show_header_toggle: false
        show_empty: false
        sort:
          method: name
        card:
          type: history-graph
          hours_to_show: 72
        filter:
          include:
            - entity_id: "/sensor..*_skipped_fps$/"

  - title: Climate
    icon: mdi:temperature-fahrenheit
    cards:
      - type: thermostat
        entity: climate.downstairs
      - type: thermostat
        entity: climate.upstairs

      - type: entities
        show_header_toggle: false
        entities:
          - automation.upstairs_ac
          - automation.upstairs_heat
          - automation.upstairs_reading
          - automation.upstairs_sleeping
          - automation.upstairs_morning_climate_reset

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: outdoor temperature
          hours_to_show: 36
          show:
            fill: false
            state: false
        filter:
          include:
            - entity_id: "/^sensor.*_temperature/"
          exclude:
            - entity_id: "/^sensor.*_air_temperature$/"
            - entity_id: "/diskstation/"
            - entity_id: "/synology/"
            - entity_id: "/iComfort/"

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: humidity
          hours_to_show: 36
          show:
            fill: false
            state: false
        filter:
          include:
            - entity_id: "/^sensor.*_humidity/"

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: indoor temperature
          hours_to_show: 36
          show:
            fill: false
            state: false
        filter:
          include:
            - entity_id: "/^sensor.*_air_temperature$/"
          exclude:
            - entity_id: sensor.wine_room_air_temperature

      - type: custom:mini-graph-card
        show:
          fill: false
          extrema: true
          state: false
        entities:
          - entity: sensor.wine_room_air_temperature
            aggregate_func: max
            name: Max
            color: #e74c3c
          - entity: sensor.wine_room_air_temperature
            aggregate_func: min
            name: Min
          - entity: sensor.wine_room_air_temperature
            aggregate_func: avg
            name: Avg
            color: green
        name: wine room
        hours_to_show: 168
        group_by: hour

      - type: custom:auto-entities
        card:
          type: custom:mini-graph-card
          name: light
          hours_to_show: 36
          show:
            fill: false
            state: false
        filter:
          include:
            - entity_id: "/^sensor.*_light$/"
            - entity_id: "/^sensor.*_illuminance$/"

  - title: Core
    icon: mdi:server-network
    cards:
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 12
        filter:
          include:
            - entity_id: "/ups_/"

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: glance
          title: nas
        filter:
          include:
            - entity_id: "/diskstation/"
            - entity_id: "/synology/"
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/diskstation/"
            - entity_id: "/synology/"
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/dcp_l2540dw/"

  - title: Lights
    icon: mdi:lightbulb
    cards:
      - type: custom:auto-entities
        show_empty: false
        sort:
          method: name
        card:
          type: entities
          title: lights on
        filter:
          include:
            - domain: light
          exclude:
            - entity_id: "/_[0-9]+$/"
            - state: "off"
            - state: "unavailable"
      - type: custom:auto-entities
        sort:
          method: name
        show_empty: false
        card:
          type: entities
          title: lights off
        filter:
          include:
            - domain: light
              state: "off"
              options:
                tap_action:
                  action: toggle
          exclude:
            - entity_id: "/_[0-9]+$/"

  - title: Batteries
    icon: mdi:battery
    cards:
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/.*battery_level/"
          exclude:
            - state: "off"

  - title: Car
    icon: mdi:car-estate
    path: car
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - switch.xc60_climate

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: entities
          show_header_toggle: false
        filter:
          include:
            - entity_id: "/^sensor.xc60/"

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/^sensor.xc60.*_level/"

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/^sensor.xc60.*_range/"

      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: history-graph
          hours_to_show: 80
        filter:
          include:
            - entity_id: "/^binary_sensor.xc60/"

  - title: Traffic
    icon: mdi:traffic-light
    cards:
      - type: picture
        image: https://cctv.austinmobility.io/image/336.jpg
      - type: picture
        image: https://cctv.austinmobility.io/image/67.jpg
      - type: picture
        image: https://cctv.austinmobility.io/image/65.jpg
      - type: picture
        image: https://cctv.austinmobility.io/image/111.jpg
      - type: picture
        image: https://cctv.austinmobility.io/image/547.jpg
      - type: picture
        image: https://cctv.austinmobility.io/image/244.jpg

  - title: Zwave
    icon: mdi:z-wave
    cards:
      - type: markdown
        content: |
          ## ZWave Device Docs

          * [Multisensor](https://www.smarthome.com.au/media/manuals/aeotec-z-wave-multisensor-6_manual.pdf)
            * PIR sensitivity sometimes resets to 0 when pairing. Should be 5.
          * [Appliance module / energy sensor](https://doc.eedomus.com/files/Aeon_Labs_Smart_Energy_Switch_MANUAL_US.pdf)
          * [Two outlet wall wart](https://minoston.com/wp-content/uploads/2020/08/MP20Z-Manual.pdf)
          * [Crescent-shaped dimming wart](http://z-wave-assets.s3-us-west-2.amazonaws.com/docs/390/remotec_ZDS-110_user-manual.pdf?1494455193)
          * [GE ZWave in-wall switch](https://byjasco.com/mwdownloads/download/link/id/2038/)
          * [Fibrao flood sensor](https://manuals.fibaro.com/content/manuals/en/FGFS-101/FGFS-101-EN-T-v2.1.pdf)
          * [Aeotec water sensor](https://help.aeotec.com/support/solutions/articles/6000171886-water-sensor-6-user-guide-)
          * [Recessed door sensor](https://help.aeotec.com/support/solutions/articles/6000226848-recessed-door-sensor-7-user-guide-)
          * [Light strip controller](https://enerwaveautomation.com/wp-content/uploads/products/zwnrsm1s/ZWN-RSM1-Plus-0208160043-02.pdf)
          * [GE outdoor smart switch](https://byjasco.com/mwdownloads/download/link/id/1960/)
          * [GoControl Zwave bulb](https://www.gocontrol.com/manuals/LB60Z-1-Install.pdf)
          * [Range extender 6](https://help.aeotec.com/support/solutions/articles/6000162370-range-extender-6-user-guide-)
          * [Ecolink PIR](https://usermanual.wiki/Z-Wave/EcolinkPirzwave2Eco.1230161169)

      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 72
          title: nodes with abnormal status
        filter:
          include:
            - entity_id: "/^sensor.*_node_status$/"
          exclude:
            - state: "alive"
            - state: "asleep"

      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 72
          title: node status
        filter:
          include:
            - entity_id: "/^sensor.*_node_status$/"

  - title: Tula
    icon: mdi:triangle-outline
    cards:
      - type: history-graph
        title: balance
        hours_to_show: 80
        entities:
          - sensor.tula_hours_balance
      - type: history-graph
        title: todos
        hours_to_show: 80
        entities:
          - sensor.tula_todos_in_progress
          - sensor.tula_todos_pending
      - type: history-graph
        title: hours saved
        hours_to_show: 80
        entities:
          - sensor.tula_hours_saved
      - type: markdown
        content: |
          {% set todos = state_attr('sensor.tula', 'todos') | selectattr("fields.listStatus", "==", "inProgress") | sort(attribute="createdTime") | list %}
          {% for todo in todos -%}
          * {{ todo.fields.itemNames | first }} assigned to {{ todo.fields.assistantName | first }} (<a href="tel:{{ todo.fields.assistantPhone | first }}">{{ todo.fields.assistantPhone | first }}</a>)
          {% endfor %}

  - title: Settings
    icon: mdi:cog
    cards:
      - type: entities
        title: settings
        show_header_toggle: false
        entities:
          - input_boolean.guests
          - automation.away_mode
          - input_boolean.christmas
          - vacuum.downstairs
      - type: entities
        entities:
          - sensor.current_version
          - sensor.config_sha
          - sensor.latest_deployment_sha
      - type: custom:auto-entities
        show_empty: false
        sort:
          method: id
        card:
          type: glance
          title: unconfigured
        filter:
          include:
            - entity_id: "/_[0-9]+$/"
          exclude:
            - integration: mobile_app
            - entity_id: "*_sim_*"
            - entity_id: "/volume_[0-9]+$/"
            - entity_id: "/trip_meter_[0-9]+$/"
      - type: history-graph
        title: history
        hours_to_show: 80
        entities:
          - counter.light_automations
          - counter.errors
          - input_select.mode
          - binary_sensor.together
          - device_tracker.jphone_12
          - sensor.jphone_12_battery_state
          - device_tracker.katie_s_iphone
          - sensor.katie_s_iphone_battery_state
          - sensor.laundry_power
          - binary_sensor.laundry
          - sun.sun
          - weather.dark_sky
      - type: custom:auto-entities
        card:
          type: history-graph
          hours_to_show: 72
          title: motion
        filter:
          include:
            - entity_id: "/^binary_sensor.*_motion_detection$/"
            - entity_id: "/^binary_sensor.*_motion$/"
