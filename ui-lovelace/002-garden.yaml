title: Garden
path: garden
icon: mdi:sprout
cards:
  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: Greenhouse
    filter:
      include:
        - entity_id: automation.greenhouse_led_automation
        - domain: light
          device: /greenhouse/
        - entity_id: /light.mother/
        - entity_id: /light.grow/
  - type: conditional
    conditions:
      - entity: automation.greenhouse_led_automation
        state: "on"
    card:
      type: entities
      title: Greenhouse LED automation
      show_header_toggle: false
      entities:
        - input_datetime.greenhouse_led_on
        - input_datetime.greenhouse_led_off
  - type: conditional
    conditions:
      - entity: camera.garage
        state: recording
    card:
      type: picture-entity
      camera_view: auto
      show_name: false
      show_state: false
      entity: camera.garage
  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: quick run
    filter:
      include:
        - entity_id: "/.*_zone$/"
        - entity_id: "/.*_schedule$/"
  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: runtime
    filter:
      include:
        - entity_id: "/.*_zone_runtime$/"
        - entity_id: "/.*_schedule$/"
          options:
            type: attribute
            attribute: Duration

  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: toggle schedules
    filter:
      include:
        - entity_id: "/.*_program$/"
  - type: markdown
    content: |
      {% for program in states.switch|selectattr('attributes.is_smart_program','defined') %}
      {%- if program.state == "on" %}
      * {{ program.name }} runs for {{ program.attributes.run_times | map(attribute='run_time') | join(', ') }} minutes at {{ program.attributes.start_times | join(', ') }} on {{ program.attributes.frequency.days | default([program.attributes.frequency.interval | default(program.attributes.frequency.type)]) | join }} day {{ program.attributes.frequency.type }}
      {%- endif -%}
      {%- endfor -%}
      {% for program in states.switch | selectattr('attributes.Duration', 'defined') %}
      {%- if program.attributes.Enabled %}
      * {{ program.name }} runs for {{ program.attributes.Duration }} {{ program.attributes.Summary | lower }}
      {%- endif -%}
      {%- endfor -%}
  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: last run
    filter:
      include:
        - integration: bhyve
          entity_id: "/.*_history$/"
  - type: custom:auto-entities
    card:
      type: entities
      show_header_toggle: false
      title: rain delay
    filter:
      include:
        - entity_id: "/.*_rain_delay$/"
  - type: custom:mini-graph-card
    entities:
      - entity: sensor.precipitation
    name: hourly precipitation
    aggregate_func: sum
    hours_to_show: 168
    group_by: hour
    show:
      fill: false
      extrema: true

  - type: custom:mini-graph-card
    entities:
      - entity: sensor.precipitation
    name: daily precipitation
    aggregate_func: sum
    hours_to_show: 168
    group_by: date
    show:
      fill: false
      extrema: true
  - type: custom:auto-entities
    card:
      type: custom:mini-graph-card
      name: irrigation zone runtime
      hours_to_show: 168
      group_by: date
      smoothing: false
      show:
        fill: false
        legend: false
        state: false
        points: hover
    filter:
      include:
        - entity_id: "/.*_zone_daily_runtime$/"
          options:
            aggregate_func: max
            unit: hours
  - type: custom:auto-entities
    sort:
      method: name
      reverse: true
    card:
      type: custom:mini-graph-card
      hours_to_show: 168
      group_by: hour
      show:
        extrema: true
        fill: false
    filter:
      include:
        - integration: xiaomi_ble
          entity_id: "/.*_conductivity$/"
  - type: custom:auto-entities
    sort:
      method: name
      reverse: true
    card:
      type: custom:mini-graph-card
      hours_to_show: 168
      group_by: hour
      show:
        extrema: true
        fill: false
    filter:
      include:
        - integration: xiaomi_ble
          entity_id: "/.*_moisture$/"
  - type: custom:auto-entities
    sort:
      method: name
      reverse: true
    card:
      type: custom:mini-graph-card
      hours_to_show: 168
      group_by: hour
      show:
        extrema: true
        fill: false
    filter:
      include:
        - integration: xiaomi_ble
          entity_id: "/.*_illuminance$/"
  - type: custom:auto-entities
    sort:
      method: name
      reverse: true
    card:
      type: custom:mini-graph-card
      hours_to_show: 168
      group_by: hour
      show:
        extrema: true
        fill: false
    filter:
      include:
        - integration: xiaomi_ble
          entity_id: "/.*_temperature$/"

  - type: custom:mini-graph-card
    entities:
      - entity: sensor.tomorrow_io_home_feels_like
        aggregate_func: max
        name: Max
        color: #e74c3c
      - entity: sensor.tomorrow_io_home_feels_like
        aggregate_func: min
        name: Min
      - entity: sensor.tomorrow_io_home_feels_like
        aggregate_func: avg
        name: Avg
        color: green
    name: historical temperature range
    hours_to_show: 168
    group_by: date
    show:
      fill: false
      extrema: true
  - type: conditional
    conditions:
      - entity: camera.veggiecam
        state: recording
    card:
      type: picture-entity
      camera_view: auto
      show_name: false
      show_state: false
      entity: camera.veggiecam
  - type: conditional
    conditions:
      - entity: camera.gate
        state: recording
    card:
      type: picture-entity
      camera_view: auto
      show_name: false
      show_state: false
      entity: camera.gate
